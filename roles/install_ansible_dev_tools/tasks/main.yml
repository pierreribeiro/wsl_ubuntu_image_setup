---
- name: Create the /dev/mqueue directory
  ansible.builtin.file:
    path: /dev/mqueue
    state: directory
    mode: '0755'
  become: true
  register: mqueue_result

- name: Debug - Mostrar resultado da criação do diretório /dev/mqueue
  debug:
    var: mqueue_result
    verbosity: 3

- name: Install python pipx via apt package
  become: true
  ansible.builtin.package:
    name: "{{ install_ansible_dev_tools_pipx_package }}"
    state: present
  register: pipx_result

- name: Debug - Mostrar resultado da instalação do pipx
  debug:
    var: pipx_result
    verbosity: 3

- name: Install ansible-dev-tools via pipx
  become: true
  become_user: "{{ install_ansible_dev_tools_v_username }}"
  community.general.pipx:
    name: "{{ install_ansible_dev_tools_ansible_dev_package }}"
    executable: "{{ install_ansible_dev_tools_pipx_executable }}"
    state: present
  register: ansible_dev_tools_result

- name: Debug - Mostrar resultado da instalação do ansible-dev-tools
  debug:
    var: ansible_dev_tools_result
    verbosity: 3 

- name: Ensure that command pipx ensurepath is executed after ansible-dev-tools installation
  become: true
  become_user: "{{ install_ansible_dev_tools_v_username }}"
  ansible.builtin.command: "{{ install_ansible_dev_tools_pipx_executable }} ensurepath"
  args:
    creates: "{{ ansible_env.HOME }}/.local/bin"
  register: pipx_ensurepath_result

- name: Debug - Mostrar resultado da execução do pipx ensurepath
  debug:
    var: pipx_ensurepath_result
    verbosity: 3 

- name: Pull ansible-navigator-demo-ee podman image latest
  containers.podman.podman_image:
    name: quay.io/ansible/ansible-navigator-demo-ee
    tag: latest
  become_user: "{{ install_ansible_dev_tools_v_username }}"
  become: true
  register: podman_image_result

- name: Debug - Mostrar resultado da pull do podman image
  debug:
    var: podman_image_result
    verbosity: 3

- name: Pull ansible-navigator-demo-ee podman image 0.6.0
  containers.podman.podman_image:
    name: quay.io/ansible/ansible-navigator-demo-ee
    tag: 0.6.0
  become_user: "{{ install_ansible_dev_tools_v_username }}"
  become: true
  register: podman_image_0_6_0_result

- name: Debug - Mostrar resultado da pull do podman image 0.6.0
  debug:
    var: podman_image_0_6_0_result
    verbosity: 3

- name: Run source command as user
  ansible.builtin.shell: source ~/.profile
  args:
    executable: /bin/bash
    creates: ~/.profile
  become_user: "{{ install_ansible_dev_tools_v_username }}"
  become: true
  register: source_result

- name: Debug - Mostrar resultado do source ~/.profile
  debug:
    var: source_result
    verbosity: 3